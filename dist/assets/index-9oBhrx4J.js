(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();class V{vehicles=[];nextId=1;create(e){e.id=this.nextId++,this.vehicles.push(e)}findAll(){return this.vehicles}findById(e){return this.vehicles.find(t=>t.id===e)}delete(e){this.vehicles=this.vehicles.filter(t=>t.id!==e)}update(e,t){const r=this.vehicles.findIndex(i=>i.id===e);if(r!==-1){const i=this.vehicles[r];Object.assign(i,t)}}}class b{constructor(e){this.repository=e}addVehicle(e){if(e.year<1886)throw new Error("Vehicle year cannot be before 1886 (creation of the first car).");this.repository.create(e)}getAllVehicles(){return this.repository.findAll()}removeVehicle(e){this.repository.delete(e)}updateVehicle(e,t){if(t.year&&t.year<1886)throw new Error("Vehicle year cannot be before 1886.");this.repository.update(e,t)}getVehicleById(e){return this.repository.findById(e)}}class f{constructor(e,t,r,i,s){this.id=e,this.make=t,this.model=r,this.year=i,this.type=s}}class p extends f{constructor(e,t,r,i,s){super(e,t,r,i,"Car"),this.numDoors=s}displayInfo(){return`Car: ${this.year} ${this.make} ${this.model} (${this.numDoors} doors)`}}class v extends f{constructor(e,t,r,i,s){super(e,t,r,i,"Bike"),this.hasSideCar=s}displayInfo(){return`Bike: ${this.year} ${this.make} ${this.model} ${this.hasSideCar?"(with Sidecar)":"(no Sidecar)"}`}}class B{constructor(e,t){this.service=e,this.renderCb=t}handleAddVehicle(e,t,r,i,s){let o;try{e==="Car"?o=new p(0,t,r,i,parseInt(s)):o=new v(0,t,r,i,!!s),this.service.addVehicle(o),this.refreshView()}catch(l){alert(l.message)}}handleDeleteVehicle(e){this.service.removeVehicle(e),this.refreshView()}handleUpdateVehicle(e,t,r,i,s,o){let l={make:r,model:i,year:s,type:t};t==="Car"?l.numDoors=parseInt(o):l.hasSideCar=!!o;try{this.service.updateVehicle(e,l),this.refreshView()}catch(E){alert(E.message)}}getVehicle(e){return this.service.getVehicleById(e)}refreshView(){const e=this.service.getAllVehicles();this.renderCb(e)}}const C=new V,w=new b(C),h=document.getElementById("vehicleList"),u=document.getElementById("vehicleForm"),g=document.getElementById("formTitle"),a=document.getElementById("vehicleId"),I=u.querySelector('button[type="submit"]'),c=document.getElementById("type"),m=document.getElementById("carFields"),y=document.getElementById("bikeFields"),S=n=>{if(h.innerHTML="",n.length===0){h.innerHTML="<p>No vehicles in inventory.</p>";return}n.forEach(e=>{const t=document.createElement("div");t.className="vehicle-item",t.innerHTML=`
            <div class="vehicle-info">
                <strong>${e.type.toUpperCase()}</strong> - ${e.displayInfo()}
            </div>
            <div class="actions">
                <button class="edit-btn" data-id="${e.id}">Edit</button>
                <button class="delete-btn" data-id="${e.id}">Delete</button>
            </div>
        `,h.appendChild(t)}),document.querySelectorAll(".delete-btn").forEach(e=>{e.addEventListener("click",t=>{const r=parseInt(t.target.dataset.id);confirm("Are you sure you want to delete this vehicle?")&&d.handleDeleteVehicle(r)})}),document.querySelectorAll(".edit-btn").forEach(e=>{e.addEventListener("click",t=>{const r=parseInt(t.target.dataset.id),i=d.getVehicle(r);i&&L(i)})})},d=new B(w,S);function L(n){g.textContent="Edit Vehicle",I.textContent="Update Vehicle",a.value=n.id.toString(),c.value=n.type,document.getElementById("make").value=n.make,document.getElementById("model").value=n.model,document.getElementById("year").value=n.year.toString(),c.dispatchEvent(new Event("change")),n instanceof p?document.getElementById("numDoors").value=n.numDoors.toString():n instanceof v&&(document.getElementById("hasSideCar").checked=n.hasSideCar)}c.addEventListener("change",()=>{c.value==="Car"?(m.style.display="block",y.style.display="none"):(m.style.display="none",y.style.display="block")});u.addEventListener("submit",n=>{n.preventDefault();const e=a.value?parseInt(a.value):null,t=c.value,r=document.getElementById("make").value,i=document.getElementById("model").value,s=parseInt(document.getElementById("year").value);let o;t==="Car"?o=document.getElementById("numDoors").value||4:o=document.getElementById("hasSideCar").checked,e?(d.handleUpdateVehicle(e,t,r,i,s,o),g.textContent="Add New Vehicle",I.textContent="Add Vehicle",a.value=""):d.handleAddVehicle(t,r,i,s,o),u.reset(),c.dispatchEvent(new Event("change"))});d.refreshView();
